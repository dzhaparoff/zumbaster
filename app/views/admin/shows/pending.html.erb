<% title "Сериалы" %>
<div class="row">
  <div class="medium-12 column">
    <p></p>
    <table width="100%">
      <caption>Количество сериалов: <%= @shows.count %></caption>
      <thead>
      <tr>
        <th>id</th>
        <th>Название</th>
        <th>Кинопоиск</th>
        <th>Статус</th>
      </tr>
      </thead>
      <tbody data-resource="shows">
      <%- @shows.each do |show| %>
          <tr>
            <td><%= show.id %></td>
            <td><%= show.title_ru %> (<%= show.title_en %>)</td>
            <td><%= link_to 'кинопоиск', "http://kinopoisk.ru/film/#{show.ids['kp']}", target: '_blank' %></td>
            <td><%= show.status %></td>
          </tr>
          <tr>
            <td colspan="4">
              <div class="row" data-model-item="<%= show.id %>" data-model="Show">
                <div class="small-6 columns">
                  IMDB
                  <div data-ng-model="item.model.ids.imdb" class="contenteditable" data-ng-class="main.helpers.class(item.editable, 'editable', 'not-editable')" contenteditable="{{item.editable}}" data-item-type="int"><%= show.ids["imdb"] %></div>
                </div>
                <div class="small-6 columns">
                  KinoPoisk
                  <div data-ng-model="item.model.ids.kp" class="contenteditable" data-ng-class="main.helpers.class(item.editable, 'editable', 'not-editable')" contenteditable="{{item.editable}}" data-item-type="int"><%= show.ids["kp"] %></div>
                </div>
                <div class="small-12 columns">
                    <div data-ng-model="item.model.description_ru" class="contenteditable" data-ng-class="main.helpers.class(item.editable, 'editable', 'not-editable')" contenteditable="{{item.editable}}"><%== show.description_ru %></div>
                    <div class="text-right">
                      <button class="button tiny" data-ng-if="!item.editable"  data-ng-click="editor.edit_item(item)">Редактировать</button>
                      <button class="button tiny success" data-ng-if="item.editable" data-ng-click="editor.save_item(item)">Сохранить</button>
                      <button class="button tiny alert" data-ng-if="item.editable" data-ng-click="editor.delete_item(item)">Удалить</button>
                      <button class="button tiny alert" data-ng-if="item.editable" data-ng-click="editor.cancel_edit_item(item)">Отменить</button>
                    </div>
                </div>
              </div>
            </td>
          </tr>
          <tr fill-show="<%= show.id %>" data-ng-class="show.api.loading.class" class="loading-fade">
            <td colspan="4">
              <div class="row">
                <div class="small-2 column"><button class="button tiny expand" data-ng-click="show.actions.post('sync_with_trakt')" data-ng-disabled="show.api.loading.shows_sync_with_trakt.loading">Заполнить инфу</button></div>
                <div class="small-2 column"><button class="button tiny expand" data-ng-click="show.actions.post('sync_translate')" data-ng-disabled="show.api.loading.shows_sync_translate.loading">Заполнить русскую инфу</button></div>
                <div class="small-2 column"><button class="button tiny expand" data-ng-click="show.actions.post('sync_pics')" data-ng-disabled="show.api.loading.shows_sync_pics.loading">Добавить постеры и фан-арт</button></div>
                <div class="small-2 column"><button class="button tiny expand" data-ng-click="show.actions.post('sync_ru_pics')" data-ng-disabled="show.api.loading.shows_sync_ru_pics.loading">Добавить русские постеры</button></div>
                <div class="small-2 column"><button class="button tiny expand" data-ng-click="show.actions.post('sync_rating')" data-ng-disabled="show.api.loading.shows_sync_rating.loading">Синхронизировать рейтинг</button></div>
                <div class="small-2 column"><button class="button tiny expand" data-ng-click="show.actions.post('sync_people')" data-ng-disabled="show.api.loading.shows_sync_people.loading">Добавить PEOPLE</button></div>
              </div>
              <div class="row">
                <div class="small-12 column"><button class="button tiny" data-ng-click="show.actions.post('activate')" data-ng-disabled="show.api.loading.loading">Активировать</button></div>
              </div>
            </td>
          </tr>
      <% end -%>
      </tbody>
    </table>
  </div>
</div>