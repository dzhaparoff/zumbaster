<% title "Сериал #{@show.title_ru}" %>
<div class="row" data-resource="shows">
  <div class="medium-3 column">
    <img src="<%= @show.poster_ru.url(:thumb) %>" alt=""/>
    <div fill-show="<%= @show.id %>" data-ng-class="show.api.loading.class" class="loading-fade">
      <div
      class="tiny expand"
      data-title="Обновить все сезоны"
      data-progress-button="show.api.progress.shows_sync_seasons"
      data-click="show.actions.post('sync_seasons')"
      ></div>
      <button class="button tiny expand" data-ng-click="show.actions.post('sync_videos')" data-ng-disabled="show.api.loading.shows_sync_videos.loading">Обновить все видео эпизодов</button>
      <button class="button tiny expand" data-ng-click="show.actions.post('sync_ru_names')" data-ng-disabled="show.api.loading.shows_sync_ru_names.loading">Обновить названия эпизодов</button>
      <button class="button tiny expand" data-ng-click="show.actions.post('sync_rating')" data-ng-disabled="show.api.loading.shows_sync_rating.loading">Синхронизировать рейтинг</button>
    </div>
  </div>
  <div class="medium-9 column">
    <h1><%= @show.title_ru %></h1>
    <div data-model-item="<%= @show.id %>" data-model="Show">
      <div data-ng-model="item.model.description_ru" class="contenteditable" data-ng-class="main.helpers.class(item.editable, 'editable', 'not-editable')" contenteditable="{{item.editable}}"><%== @show.description_ru %></div>
      <div class="text-right">
        <button class="button tiny" data-ng-if="!item.editable"  data-ng-click="editor.edit_item(item)">Редактировать</button>
        <button class="button tiny success" data-ng-if="item.editable" data-ng-click="editor.save_item(item)">Сохранить</button>
        <button class="button tiny alert" data-ng-if="item.editable" data-ng-click="editor.cancel_edit_item(item)">Отменить</button>
      </div>
    </div>
    <table width="100%">
      <thead>
      <tr>
        <th colspan="2"></th>
        <th>Количество эпизодов</th>
        <th>Эпизодов вышло</th>
        <th></th>
      </tr>
      </thead>
      <% @seasons.each do |season| %>
          <tr>
            <td><%= image_tag season.poster.url(:thumb), width: 100 %></td>
            <td>Сезон <%= season.number %></td>
            <td><%= season.episode_count %></td>
            <td><%= season.aired_episodes %></td>
            <td><button class="button tiny">Обновить эпизоды</button></td>
          </tr>
      <% end %>
    </table>
  </div>
</div>
<div class="row">
  <div class="medium-12 column">

  </div>
</div>